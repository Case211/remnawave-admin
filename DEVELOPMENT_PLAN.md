# üìã –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è Remnawave Admin Bot

> **–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 4.0
> **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 26.01.2026
> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 01.02.2026
> **–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** 1.6.x

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

**–ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ Telegram –±–æ—Ç –Ω–∞ aiogram 3.12 —Å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é
- ‚úÖ PostgreSQL –±–∞–∑–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ users, nodes, hosts, user_connections
- ‚úÖ REST API –∫–ª–∏–µ–Ω—Ç –∫ Remnawave (~60 –º–µ—Ç–æ–¥–æ–≤)
- ‚úÖ Webhook —Å–µ—Ä–≤–µ—Ä –¥–ª—è real-time —Å–æ–±—ã—Ç–∏–π
- ‚úÖ HWID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ/–ª–∏–º–∏—Ç—ã)
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `user_connections` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è IP –∞–¥—Ä–µ—Å–æ–≤
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ —Ç–æ–ø–∏–∫–∞–º
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**Anti-Abuse —Å–∏—Å—Ç–µ–º–∞ (–ø–æ–ª–Ω–æ—Å—Ç—å—é):**
- ‚úÖ Collector API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç Node Agent
- ‚úÖ IntelligentViolationDetector —Å 5 –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞–º–∏:
  - TemporalAnalyzer (–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã)
  - GeoAnalyzer (–≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑)
  - ASNAnalyzer (—Ç–∏–ø –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞)
  - UserProfileAnalyzer (–ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)
  - DeviceFingerprintAnalyzer (fingerprint —É—Å—Ç—Ä–æ–π—Å—Ç–≤)
- ‚úÖ GeoIP —Å–µ—Ä–≤–∏—Å (MaxMind GeoLite2)
- ‚úÖ ConnectionMonitor –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ ASN Parser –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

**–û—Ç—á—ë—Ç—ã –æ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö:**
- ‚úÖ ViolationReportService (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤)
- ‚úÖ ReportScheduler (daily/weekly/monthly)
- ‚úÖ UI –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤ –≤ Telegram –±–æ—Ç–µ

**–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- ‚úÖ DynamicConfigService –¥–ª—è runtime –Ω–∞—Å—Ç—Ä–æ–µ–∫
- ‚úÖ UI –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –±–æ—Ç–µ

### ‚ùå –ß–µ–≥–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç:
- **Node Agent** ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å –Ω–æ–¥
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏ —á–µ—Ä–µ–∑ Telegram
- –°–∏—Å—Ç–µ–º–∞ –∞–ø–µ–ª–ª—è—Ü–∏–π
- Trust Score —Å–∏—Å—Ç–µ–º–∞
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–æ–≤ (CSV, PDF)
- Rules Engine –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

---

## üéØ –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ —Ü–µ–ª–∏

1. **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö** ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ real-time –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è—Ö
2. **Anti-Abuse —Å–∏—Å—Ç–µ–º–∞** ‚Äî –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —à–∞—Ä–∏–Ω–≥–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ ‚úÖ
3. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç—á—ë—Ç—ã
4. **–í–µ–±-–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** ‚Äî –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π UI –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
5. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞
6. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã** ‚Äî –∑–¥–æ—Ä–æ–≤—å–µ –Ω–æ–¥ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç ‚Äî **–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –±–∏–ª–ª–∏–Ω–≥ –Ω–µ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω.

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è—Ö

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ Remnawave API

**Remnawave API –ù–ï –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:**
- ‚ùå –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚ùå IP –∞–¥—Ä–µ—Å–∞ —Ç–µ–∫—É—â–∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- ‚ùå –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- ‚ùå –°–æ–±—ã—Ç–∏—è `user.connected` / `user.disconnected` —Å IP

**Remnawave API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:**
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ç—Ä–∞—Ñ–∏–∫–∞ (–∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—É—é)
- ‚úÖ HWID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–Ω–æ —ç—Ç–æ –Ω–µ IP!)
- ‚úÖ Webhook —Å–æ–±—ã—Ç–∏—è (–Ω–æ –±–µ–∑ –¥–µ—Ç–∞–ª–µ–π –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)
- ‚úÖ `subscription_request_history` (–∏—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–æ–Ω—Ñ–∏–≥–∞, –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π)

### –í—ã–≤–æ–¥

**–ë–µ–∑ Node Agent —Å–∏—Å—Ç–µ–º–∞ Anti-Abuse —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ!**

–ù—É–∂–µ–Ω –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è—Ö –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å –Ω–æ–¥ (—Å–µ—Ä–≤–µ—Ä–æ–≤ —Å Xray/Sing-box).

---

## üöÄ –§–∞–∑–∞ 0: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### ‚úÖ Collector API (–ì–û–¢–û–í–û)

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `src/services/collector.py`:
- Endpoint POST /api/v1/connections/batch
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–æ–≤ (—Ç–æ–∫–µ–Ω—ã)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ó–∞–ø–∏—Å—å –≤ user_connections
- –¢—Ä–∏–≥–≥–µ—Ä –ø—Ä–æ–≤–µ—Ä–∫–∏ Anti-Abuse

### ‚ùå Node Agent (–¢–†–ï–ë–£–ï–¢–°–Ø –†–ê–ó–†–ê–ë–û–¢–ö–ê)

**–û—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `remnawave-node-agent`

```
remnawave-node-agent/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # Entry point
‚îÇ   ‚îú‚îÄ‚îÄ config.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ collectors/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py          # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ xray_log.py      # –ü–∞—Ä—Å–µ—Ä access.log
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ xray_stats.py    # gRPC Stats API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ singbox.py       # –î–ª—è Sing-box
‚îÇ   ‚îú‚îÄ‚îÄ sender.py            # HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ models.py            # Pydantic –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

**–ó–∞–¥–∞—á–∏:**
```
[ ] –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ: –∫–∞–∫ Xray –ª–æ–≥–∏—Ä—É–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
    - –§–æ—Ä–º–∞—Ç—ã access.log
    - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Stats API
    - –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

[ ] –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ Node Agent
    - –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
    - –ü–∞—Ä—Å–µ—Ä –ª–æ–≥–æ–≤ Xray
    - HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
    - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    - Docker –æ–±—Ä–∞–∑ –¥–ª—è –¥–µ–ø–ª–æ—è

[ ] –î–µ–ø–ª–æ–π –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≥–µ–Ω—Ç–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—É—é –Ω–æ–¥—É
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
    - –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
```

---

## üöÄ –§–∞–∑–∞ 1: Anti-Abuse —Å–∏—Å—Ç–µ–º–∞ ‚Äî ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

### ‚úÖ 1.1 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ IP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π (–ì–û–¢–û–í–û)

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç Node Agent
- –ó–∞–ø–∏—Å—å –≤ user_connections —Å geo-–¥–∞–Ω–Ω—ã–º–∏
- ConnectionMonitor —Å–µ—Ä–≤–∏—Å
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–æ –≤—Å–µ—Ö –Ω–æ–¥
- –ü–æ–¥—Å—á—ë—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö IP –∑–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ

### ‚úÖ 1.2 –ú–Ω–æ–≥–æ—Ñ–∞–∫—Ç–æ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (–ì–û–¢–û–í–û)

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `src/services/violation_detector.py`:

| –§–∞–∫—Ç–æ—Ä | –ö–ª–∞—Å—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-------|----------|
| Temporal | TemporalAnalyzer | –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å–º–µ–Ω—ã IP |
| Geo | GeoAnalyzer | –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ |
| ASN | ASNAnalyzer | –¢–∏–ø –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (mobile/residential/datacenter) |
| Profile | UserProfileAnalyzer | –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è |
| Device | DeviceFingerprintAnalyzer | Fingerprint —É—Å—Ç—Ä–æ–π—Å—Ç–≤ |

### ‚úÖ 1.3 –°–∫–æ—Ä–∏–Ω–≥ –Ω–∞—Ä—É—à–µ–Ω–∏–π (–ì–û–¢–û–í–û)

–°–∏—Å—Ç–µ–º–∞ –≤–µ—Å–æ–≤ –∏ –ø–æ—Ä–æ–≥–æ–≤:
```python
WEIGHTS = {
    'temporal': 0.25,
    'geo': 0.25,
    'asn': 0.15,
    'profile': 0.20,
    'device': 0.15,
}

THRESHOLDS = {
    'no_action': 30,
    'monitor': 50,
    'warn': 65,
    'soft_block': 80,
    'temp_block': 90,
    'hard_block': 95,
}
```

### ‚úÖ 1.4 –û—Ç—á—ë—Ç—ã –æ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö (–ì–û–¢–û–í–û)

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- ViolationReportService ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤
- ReportScheduler ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ (daily/weekly/monthly)
- UI –≤ Telegram –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ—Ç—á—ë—Ç–æ–≤

### ‚úÖ 1.5 –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Anti-Abuse (–ì–û–¢–û–í–û)

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ DynamicConfigService:
- –ü–æ—Ä–æ–≥–∏ —Å–∫–æ—Ä–∏–Ω–≥–∞
- –í–µ—Å–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤
- –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∏

---

## üöÄ –§–∞–∑–∞ 2: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏

### 2.1 –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**–ó–∞–¥–∞—á–∏:**
```
[ ] –†–∞–∑–¥–µ–ª "üîí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏" –≤ Telegram –±–æ—Ç–µ:
    ‚îú‚îÄ‚îÄ üìã –ê–∫—Ç–∏–≤–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
    ‚îÇ   ‚îî‚îÄ‚îÄ –°–ø–∏—Å–æ–∫ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    ‚îú‚îÄ‚îÄ üìú –ò—Å—Ç–æ—Ä–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
    ‚îÇ   ‚îî‚îÄ‚îÄ –ü–æ–∏—Å–∫ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é/–¥–∞—Ç–µ
    ‚îú‚îÄ‚îÄ ‚ûï –°–æ–∑–¥–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
    ‚îÇ   ‚îî‚îÄ‚îÄ –†—É—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–∏—á–∏–Ω—ã
    ‚îî‚îÄ‚îÄ ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

[ ] –ö–∞—Ä—Ç–æ—á–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:
    - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
    - –ü—Ä–∏—á–∏–Ω–∞ –∏ —Å–∫–æ—Ä
    - –í—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
    - –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

[ ] –ú–µ—Ö–∞–Ω–∏–∑–º "–º—è–≥–∫–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏" (Soft Limit):
    - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
    - –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
    - –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–Ω—è—Ç–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
```

### 2.2 –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —ç—Å–∫–∞–ª–∞—Ü–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

```python
ESCALATION_MATRIX = {
    ('low', 1): ('warn', None),
    ('low', 2): ('warn', None),
    ('low', 3): ('soft_limit', '30m'),
    ('medium', 1): ('warn', None),
    ('medium', 2): ('temp_block', '1h'),
    ('medium', 3): ('temp_block', '6h'),
    ('high', 1): ('temp_block', '1h'),
    ('high', 2): ('temp_block', '24h'),
    ('high', 3): ('temp_block', '7d'),
    ('critical', 1): ('temp_block', '24h'),
    ('critical', 2): ('permanent_block', None),
}
```

### 2.3 –°–∏—Å—Ç–µ–º–∞ –∞–ø–µ–ª–ª—è—Ü–∏–π (—á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–æ–≤)

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**–ó–∞–¥–∞—á–∏:**
```
[ ] –†–∞–∑–¥–µ–ª "üìù –ê–ø–µ–ª–ª—è—Ü–∏–∏" –≤ –∞–¥–º–∏–Ω-–±–æ—Ç–µ:
    ‚îú‚îÄ‚îÄ üìã –û—Ç–∫—Ä—ã—Ç—ã–µ –∞–ø–µ–ª–ª—è—Ü–∏–∏
    ‚îú‚îÄ‚îÄ ‚úÖ –†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ
    ‚îî‚îÄ‚îÄ ‚ûï –°–æ–∑–¥–∞—Ç—å –∞–ø–µ–ª–ª—è—Ü–∏—é

[ ] –°–æ–∑–¥–∞–Ω–∏–µ –∞–ø–µ–ª–ª—è—Ü–∏–∏ –∞–¥–º–∏–Ω–æ–º:
    - –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    - –í—ã–±–æ—Ä —Å–≤—è–∑–∞–Ω–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
    - –ö–∞—Ç–µ–≥–æ—Ä–∏—è (–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ/VPN/—Å–º–µ–Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞/–æ—à–∏–±–∫–∞)
    - –û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

[ ] –†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –∞–ø–µ–ª–ª—è—Ü–∏–∏:
    - –ê–Ω–∞–ª–∏–∑ —Å–∏—Å—Ç–µ–º—ã
    - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
    - –†–µ—à–µ–Ω–∏–µ (–æ–¥–æ–±—Ä–∏—Ç—å/–æ—Ç–∫–ª–æ–Ω–∏—Ç—å)
```

---

## üöÄ –§–∞–∑–∞ 3: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### 3.1 –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è IP

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

–ì–æ—Ç–æ–≤–æ:
- GeoIP —Å–µ—Ä–≤–∏—Å (MaxMind GeoLite2)
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã, –≥–æ—Ä–æ–¥–∞, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- ASN –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:
```
[ ] –†–∞—Å—à–∏—Ä–∏—Ç—å user_connections:
    - timezone
    - connection_type (residential/mobile/datacenter)
    - is_proxy, is_vpn, is_tor
```

### 3.2 –î–∞—à–±–æ—Ä–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (Telegram)

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

```
[ ] –ù–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ /analytics –∏–ª–∏ —Ä–∞–∑–¥–µ–ª –≤ –º–µ–Ω—é

[ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Anti-Abuse –∑–∞ –ø–µ—Ä–∏–æ–¥:
    üìä Anti-Abuse —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (7 –¥–Ω–µ–π)

    üîç –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 1,234
    ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: 45
    üîí –ë–ª–æ–∫–∏—Ä–æ–≤–æ–∫: 12

    üìà –ü–æ severity:
       ‚Ä¢ Low: 28 (62%)
       ‚Ä¢ Medium: 12 (27%)
       ‚Ä¢ High: 4 (9%)
       ‚Ä¢ Critical: 1 (2%)

[ ] –¢–æ–ø –Ω–∞—Ä—É—à–∏—Ç–µ–ª–µ–π
[ ] –ì–µ–æ–≥—Ä–∞—Ñ–∏—è –Ω–∞—Ä—É—à–∏—Ç–µ–ª–µ–π
```

### 3.3 –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

```
[ ] –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∞:
    - CSV —Å–æ –≤—Å–µ–º–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è–º–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥
    - JSON –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
    - Inline –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
```

### 3.4 Trust Score —Å–∏—Å—Ç–µ–º–∞

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

```python
class TrustScoreSystem:
    INITIAL_SCORE = 100
    MAX_SCORE = 150
    MIN_SCORE = 0

    SCORE_CHANGES = {
        'violation_low': -5,
        'violation_medium': -15,
        'violation_high': -30,
        'violation_critical': -50,
        'appeal_approved': +10,
        'clean_week': +2,
        'clean_month': +10,
        'long_time_customer': +20,
    }
```

---

## üöÄ –§–∞–∑–∞ 4: –í–µ–±-–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 4.1 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
remnawave-admin/
‚îú‚îÄ‚îÄ src/                      # Telegram –±–æ—Ç (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
‚îú‚îÄ‚îÄ web/
‚îÇ   ‚îú‚îÄ‚îÄ backend/              # FastAPI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/v1/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.py
‚îÇ   ‚îî‚îÄ‚îÄ frontend/             # React + TypeScript
‚îÇ       ‚îú‚îÄ‚îÄ src/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ api/
‚îÇ       ‚îî‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ docker-compose.yml
```

### 4.2 –°—Ç—Ä–∞–Ω–∏—Ü—ã –≤–µ–±-–ø–∞–Ω–µ–ª–∏

- Dashboard —Å real-time —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- Anti-Abuse Center
- User Detail —Å Anti-Abuse –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- Violations –∏ Blocks
- Settings

### 4.3 –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- Telegram Login Widget
- JWT —Ç–æ–∫–µ–Ω—ã
- Role-based access control

---

## üöÄ –§–∞–∑–∞ 5: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 5.1 Rules Engine

```
[ ] –í–∏–∑—É–∞–ª—å–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø—Ä–∞–≤–∏–ª:
    IF [condition] THEN [action]

[ ] –ü—Ä–∏–º–µ—Ä—ã –≥–æ—Ç–æ–≤—ã—Ö –ø—Ä–∞–≤–∏–ª:
    - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ traffic > X
    - –ê–≤—Ç–æ-–±–ª–æ–∫ –ø—Ä–∏ score > 95
    - –ê–ª–µ—Ä—Ç –ø—Ä–∏ > N –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è—Ö
```

### 5.2 Scheduled Tasks

```
[ ] –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á:
    - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –Ω–∞—Ä—É—à–µ–Ω–∏—è–º ‚úÖ (—É–∂–µ –µ—Å—Ç—å)
    - –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞ –¥–ª—è —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ ‚úÖ (—É–∂–µ –µ—Å—Ç—å)
    - –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö (> 90 –¥–Ω–µ–π)
    - –ü–µ—Ä–µ—Å—á—ë—Ç Trust Score (—Ä–∞–∑ –≤ –¥–µ–Ω—å)
    - Backup –Ω–∞—Å—Ç—Ä–æ–µ–∫ (—Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)
```

### 5.3 –í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```
[ ] –í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã:
    - Discord webhooks –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    - Email (SMTP) –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∞–ª–µ—Ä—Ç–æ–≤
    - Slack –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
    - Prometheus –º–µ—Ç—Ä–∏–∫–∏
    - Grafana –¥–∞—à–±–æ—Ä–¥—ã
```

---

## üÜï –§–∞–∑–∞ 6: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤

### 6.1 –ê—É–¥–∏—Ç –ª–æ–≥–∏

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

```
[ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:
    - –ö—Ç–æ, –∫–æ–≥–¥–∞, —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª
    - –ü–æ–∏—Å–∫ –ø–æ –¥–µ–π—Å—Ç–≤–∏—è–º
    - –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤

[ ] –¢–∞–±–ª–∏—Ü–∞ admin_audit_log:
    - admin_id
    - action (create_user, block_user, change_settings, etc.)
    - target_type, target_id
    - details (JSONB)
    - created_at
```

### 6.2 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–æ–¥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ (–µ—Å—Ç—å –±–∞–∑–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å)

```
[ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
    - Latency –ø—Ä–æ–≤–µ—Ä–∫–∞ (ping)
    - Load (CPU, RAM, Network)
    - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
    - Uptime
    - –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

[ ] –ö–∞—Ä—Ç–∞ –Ω–æ–¥ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π —Å—Ç–∞—Ç—É—Å–∞
```

### 6.3 –°–∏—Å—Ç–µ–º–∞ —Ç–µ–≥–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

```
[ ] –¢–µ–≥–∏/–º–µ—Ç–∫–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏:
    - VIP, –ü—Ä–æ–±–ª–µ–º–Ω—ã–π, –¢–µ—Å—Ç–æ–≤—ã–π, –∏ —Ç.–¥.
    - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–≥–∞–º
    - –¶–≤–µ—Ç–æ–≤–∞—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞

[ ] –ó–∞–º–µ—Ç–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

### 6.4 –®–∞–±–ª–æ–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

```
[ ] –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Ç–∏–ø–∏—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã:
    - –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
    - –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
    - –ò—Å—Ç—ë–∫ —Å—Ä–æ–∫ –ø–æ–¥–ø–∏—Å–∫–∏

[ ] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞–º–∏ (CRUD)
[ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —à–∞–±–ª–æ–Ω–∞—Ö ({username}, {expire_date}, etc.)
```

### 6.5 –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

```
[ ] –≠–∫—Å–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–æ—Ç–∞ –≤ JSON/YAML
[ ] –ò–º–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫
[ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup (—Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)
[ ] –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```

### 6.6 –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

```
[ ] Inline –≥—Ä–∞—Ñ–∏–∫–∏ –≤ Telegram:
    - –¢—Ä–∞—Ñ–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞ –ø–µ—Ä–∏–æ–¥
    - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
    - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —á–∞—Å–∞–º

[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
    (matplotlib, plotly -> PNG)
```

### 6.7 –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø—Ä–µ–≤—å—é

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ (–µ—Å—Ç—å bulk –æ–ø–µ—Ä–∞—Ü–∏–∏, –Ω–µ—Ç –ø—Ä–µ–≤—å—é)

```
[ ] –ü—Ä–µ–≤—å—é –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º:
    - –ü–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–æ
    - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
    - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω—ã

[ ] –û—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –º–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
    - –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è
    - –û—Ç–º–µ–Ω–∏—Ç—å –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```

### 6.8 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prometheus

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

```
[ ] –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫:
    - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞—Ä—É—à–µ–Ω–∏–π
    - –°–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–æ–¥
    - Latency API –∑–∞–ø—Ä–æ—Å–æ–≤
    - –†–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏ webhook

[ ] Endpoint /metrics –¥–ª—è Prometheus
[ ] –ì–æ—Ç–æ–≤—ã–µ Grafana –¥–∞—à–±–æ—Ä–¥—ã
```

---

## üìÖ –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞

### ‚úÖ –≠—Ç–∞–ø 0: Collector API ‚Äî –ó–ê–í–ï–†–®–Å–ù

### ‚ùå –≠—Ç–∞–ø 0.5: Node Agent (–æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, 2-3 –Ω–µ–¥–µ–ª–∏)

```
‚îú‚îÄ‚îÄ –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤ Xray
‚îú‚îÄ‚îÄ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∞–≥–µ–Ω—Ç–∞
‚îú‚îÄ‚îÄ Docker –æ–±—Ä–∞–∑
‚îî‚îÄ‚îÄ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### ‚úÖ –≠—Ç–∞–ø 1: Anti-Abuse —Å–∏—Å—Ç–µ–º–∞ ‚Äî –ó–ê–í–ï–†–®–Å–ù

### –≠—Ç–∞–ø 2: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏ (2-3 –Ω–µ–¥–µ–ª–∏)

```
‚îú‚îÄ‚îÄ –†–∞–∑–¥–µ–ª –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –≤ –∞–¥–º–∏–Ω-–±–æ—Ç–µ
‚îú‚îÄ‚îÄ –°–∏—Å—Ç–µ–º–∞ –∞–ø–µ–ª–ª—è—Ü–∏–π (—á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–æ–≤)
‚îú‚îÄ‚îÄ –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —ç—Å–∫–∞–ª–∞—Ü–∏—è
‚îî‚îÄ‚îÄ Soft limit –º–µ—Ö–∞–Ω–∏–∑–º
```

### –≠—Ç–∞–ø 3: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (2-3 –Ω–µ–¥–µ–ª–∏)

```
‚îú‚îÄ‚îÄ –î–∞—à–±–æ—Ä–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ Telegram
‚îú‚îÄ‚îÄ Trust Score —Å–∏—Å—Ç–µ–º–∞
‚îú‚îÄ‚îÄ –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–æ–≤
‚îî‚îÄ‚îÄ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è
```

### –≠—Ç–∞–ø 4: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (3-4 –Ω–µ–¥–µ–ª–∏)

```
‚îú‚îÄ‚îÄ –ê—É–¥–∏—Ç –ª–æ–≥–∏
‚îú‚îÄ‚îÄ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–æ–¥
‚îú‚îÄ‚îÄ –°–∏—Å—Ç–µ–º–∞ —Ç–µ–≥–æ–≤
‚îú‚îÄ‚îÄ –®–∞–±–ª–æ–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ Backup –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ –ì—Ä–∞—Ñ–∏–∫–∏
```

### –≠—Ç–∞–ø 5: –í–µ–±-–ø–∞–Ω–µ–ª—å (8-12 –Ω–µ–¥–µ–ª—å)

```
‚îú‚îÄ‚îÄ Backend API (FastAPI)
‚îú‚îÄ‚îÄ Frontend (React + TypeScript)
‚îú‚îÄ‚îÄ Dashboard
‚îú‚îÄ‚îÄ Anti-Abuse Center
‚îî‚îÄ‚îÄ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
```

### –≠—Ç–∞–ø 6: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (4-6 –Ω–µ–¥–µ–ª—å)

```
‚îú‚îÄ‚îÄ Rules Engine
‚îú‚îÄ‚îÄ Scheduled tasks
‚îú‚îÄ‚îÄ –í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ Prometheus/Grafana
```

---

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞

| –≠—Ç–∞–ø | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|------|--------------|--------|
| **0. Collector API** | 1 –Ω–µ–¥–µ–ª—è | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| **0.5 Node Agent** | 2-3 –Ω–µ–¥–µ–ª–∏ | ‚ùå –ù–µ –Ω–∞—á–∞—Ç–æ |
| **1. Anti-Abuse** | 4-6 –Ω–µ–¥–µ–ª—å | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| 2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ | 2-3 –Ω–µ–¥–µ–ª–∏ | ‚ùå –ù–µ –Ω–∞—á–∞—Ç–æ |
| 3. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ | 2-3 –Ω–µ–¥–µ–ª–∏ | ‚ùå –ù–µ –Ω–∞—á–∞—Ç–æ |
| 4. –î–æ–ø. –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ | 3-4 –Ω–µ–¥–µ–ª–∏ | ‚ùå –ù–µ –Ω–∞—á–∞—Ç–æ |
| 5. –í–µ–±-–ø–∞–Ω–µ–ª—å | 8-12 –Ω–µ–¥–µ–ª—å | ‚ùå –ù–µ –Ω–∞—á–∞—Ç–æ |
| 6. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è | 4-6 –Ω–µ–¥–µ–ª—å | ‚ùå –ù–µ –Ω–∞—á–∞—Ç–æ |

```
–°–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
–≠—Ç–∞–ø 2 (–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏) ‚Üí –≠—Ç–∞–ø 3 (–ê–Ω–∞–ª–∏—Ç–∏–∫–∞) ‚Üí –≠—Ç–∞–ø 4 (–î–æ–ø. –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)

–ú–æ–∂–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:
‚îú‚îÄ‚îÄ –≠—Ç–∞–ø 0.5 (Node Agent) ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç
‚îî‚îÄ‚îÄ –≠—Ç–∞–ø 4 (–î–æ–ø. –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
```

---

## üóÉÔ∏è –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ú–∏–≥—Ä–∞—Ü–∏—è: Anti-Abuse (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)

```sql
-- –ù–∞—Ä—É—à–µ–Ω–∏—è
CREATE TABLE IF NOT EXISTS violations (
    id SERIAL PRIMARY KEY,
    user_uuid UUID NOT NULL,
    violation_type VARCHAR(50) NOT NULL,
    total_score DECIMAL(5,2) NOT NULL,
    confidence DECIMAL(3,2) NOT NULL,
    severity VARCHAR(20) NOT NULL,
    hwid_limit INT NOT NULL,
    detected_ips INT NOT NULL,
    simultaneous_connections INT DEFAULT 0,
    score_breakdown JSONB NOT NULL,
    ip_addresses JSONB NOT NULL,
    action_taken VARCHAR(50),
    action_reason TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    resolved_at TIMESTAMP WITH TIME ZONE,
    resolved_by BIGINT,
    resolution_type VARCHAR(50),
    resolution_notes TEXT
);

-- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏
CREATE TABLE IF NOT EXISTS temp_blocks (
    id SERIAL PRIMARY KEY,
    user_uuid UUID NOT NULL,
    violation_id INT REFERENCES violations(id),
    block_type VARCHAR(50) NOT NULL,
    reason VARCHAR(255) NOT NULL,
    violation_score DECIMAL(5,2),
    confidence DECIMAL(3,2),
    speed_limit_bytes BIGINT,
    blocked_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    unblock_at TIMESTAMP WITH TIME ZONE,
    actual_unblock_at TIMESTAMP WITH TIME ZONE,
    blocked_by VARCHAR(100) NOT NULL,
    unblocked_by VARCHAR(100),
    is_active BOOLEAN DEFAULT TRUE,
    appeal_id INT,
    metadata JSONB
);

-- Trust Score
CREATE TABLE IF NOT EXISTS user_trust_scores (
    id SERIAL PRIMARY KEY,
    user_uuid UUID UNIQUE NOT NULL,
    current_score INT NOT NULL DEFAULT 100,
    max_score INT NOT NULL DEFAULT 100,
    min_score INT NOT NULL DEFAULT 100,
    score_history JSONB DEFAULT '[]',
    total_violations INT DEFAULT 0,
    violations_30d INT DEFAULT 0,
    last_violation_at TIMESTAMP WITH TIME ZONE,
    clean_days INT DEFAULT 0,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –ê–ø–µ–ª–ª—è—Ü–∏–∏
CREATE TABLE IF NOT EXISTS appeals (
    id SERIAL PRIMARY KEY,
    user_uuid UUID NOT NULL,
    block_id INT REFERENCES temp_blocks(id),
    violation_id INT REFERENCES violations(id),
    reason_category VARCHAR(50),
    user_message TEXT NOT NULL,
    status VARCHAR(20) DEFAULT 'pending',
    decided_by BIGINT,
    decided_at TIMESTAMP WITH TIME ZONE,
    decision_notes TEXT,
    action_taken VARCHAR(50),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –ê—É–¥–∏—Ç –ª–æ–≥–∏
CREATE TABLE IF NOT EXISTS admin_audit_log (
    id SERIAL PRIMARY KEY,
    admin_id BIGINT NOT NULL,
    action VARCHAR(100) NOT NULL,
    action_category VARCHAR(50),
    target_type VARCHAR(50),
    target_id VARCHAR(100),
    details JSONB,
    ip_address INET,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –¢–µ–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CREATE TABLE IF NOT EXISTS user_tags (
    id SERIAL PRIMARY KEY,
    user_uuid UUID NOT NULL,
    tag_name VARCHAR(50) NOT NULL,
    tag_color VARCHAR(20),
    created_by BIGINT NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    UNIQUE(user_uuid, tag_name)
);

-- –ó–∞–º–µ—Ç–∫–∏ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
CREATE TABLE IF NOT EXISTS user_notes (
    id SERIAL PRIMARY KEY,
    user_uuid UUID NOT NULL,
    note_text TEXT NOT NULL,
    created_by BIGINT NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –®–∞–±–ª–æ–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤
CREATE TABLE IF NOT EXISTS response_templates (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    category VARCHAR(50),
    template_text TEXT NOT NULL,
    variables JSONB DEFAULT '[]',
    created_by BIGINT NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX IF NOT EXISTS idx_violations_user ON violations(user_uuid);
CREATE INDEX IF NOT EXISTS idx_violations_created ON violations(created_at);
CREATE INDEX IF NOT EXISTS idx_violations_severity ON violations(severity);
CREATE INDEX IF NOT EXISTS idx_blocks_user ON temp_blocks(user_uuid);
CREATE INDEX IF NOT EXISTS idx_blocks_active ON temp_blocks(is_active) WHERE is_active = TRUE;
CREATE INDEX IF NOT EXISTS idx_appeals_status ON appeals(status);
CREATE INDEX IF NOT EXISTS idx_audit_admin ON admin_audit_log(admin_id);
CREATE INDEX IF NOT EXISTS idx_audit_created ON admin_audit_log(created_at);
CREATE INDEX IF NOT EXISTS idx_user_tags_user ON user_tags(user_uuid);
```

---

## üìù –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```env
# ===========================================
# Anti-Abuse Configuration (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
# ===========================================
ANTI_ABUSE_ENABLED=true
ANTI_ABUSE_DETECTION_INTERVAL_SECONDS=60

# –ü–æ—Ä–æ–≥–∏ —Å–∫–æ—Ä–∏–Ω–≥–∞
ANTI_ABUSE_THRESHOLD_MONITOR=30
ANTI_ABUSE_THRESHOLD_WARN=50
ANTI_ABUSE_THRESHOLD_SOFT_LIMIT=65
ANTI_ABUSE_THRESHOLD_TEMP_BLOCK=80
ANTI_ABUSE_THRESHOLD_HARD_BLOCK=95

# ===========================================
# GeoIP Configuration (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
# ===========================================
GEOIP_ENABLED=true
GEOIP_DATABASE_PATH=/data/GeoLite2-City.mmdb

# ===========================================
# Web Panel Configuration (–±—É–¥—É—â–µ–µ)
# ===========================================
WEB_PANEL_ENABLED=false
WEB_PANEL_HOST=0.0.0.0
WEB_PANEL_PORT=8081
WEB_PANEL_SECRET_KEY=your-secret-key

# ===========================================
# External Integrations (–±—É–¥—É—â–µ–µ)
# ===========================================
DISCORD_WEBHOOK_URL=
PROMETHEUS_ENABLED=false
```

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—Ç–∫–∏

### –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|------|----------|--------|
| `services/api_client.py` | REST API –∫–ª–∏–µ–Ω—Ç –∫ Remnawave | ‚úÖ |
| `services/database.py` | PostgreSQL —Å–µ—Ä–≤–∏—Å | ‚úÖ |
| `services/sync.py` | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö | ‚úÖ |
| `services/violation_detector.py` | Anti-Abuse –¥–µ—Ç–µ–∫—Ç–æ—Ä | ‚úÖ |
| `services/violation_reports.py` | –û—Ç—á—ë—Ç—ã –æ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö | ‚úÖ |
| `services/report_scheduler.py` | –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Ç—á—ë—Ç–æ–≤ | ‚úÖ |
| `services/config_service.py` | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | ‚úÖ |
| `services/geoip.py` | –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è IP | ‚úÖ |
| `services/connection_monitor.py` | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π | ‚úÖ |
| `services/collector.py` | –ü—Ä–∏—ë–º –¥–∞–Ω–Ω—ã—Ö –æ—Ç –∞–≥–µ–Ω—Ç–æ–≤ | ‚úÖ |
| `services/asn_parser.py` | –ü–∞—Ä—Å–µ—Ä ASN | ‚úÖ |

### –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `services/block_manager.py` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏ |
| `services/trust_score.py` | Trust Score —Å–∏—Å—Ç–µ–º–∞ |
| `services/appeal_handler.py` | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–ø–µ–ª–ª—è—Ü–∏–π |
| `services/audit_log.py` | –ê—É–¥–∏—Ç –ª–æ–≥–∏ |
| `handlers/blocks.py` | UI –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ |
| `handlers/appeals.py` | UI –¥–ª—è –∞–ø–µ–ª–ª—è—Ü–∏–π |
| `handlers/analytics.py` | –î–∞—à–±–æ—Ä–¥ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ |

---

*–î–æ–∫—É–º–µ–Ω—Ç –≤–µ—Ä—Å–∏–∏ 4.0. –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 01.02.2026*
